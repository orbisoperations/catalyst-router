# =============================================================================
# Zeno TAK Adapter v2 -- Environment Configuration
# =============================================================================
# Copy this file to .env and fill in the values for your deployment.
#
#   cp .env.example .env
#
# The adapter has two modes:
#   Consumer: Zenoh topics  ->  transform  ->  CoT events  ->  TAK Server
#   Producer: TAK Server    ->  CoT events ->  raw XML      ->  Zenoh topic
#
# Config schema: see src/config.ts (ZenohConfigSchema, TakConfigSchema,
# SubscriptionSchema, ProducerConfigSchema, ConfigSchema).
# =============================================================================

# -----------------------------------------------------------------------------
# Zenoh Connection (ZenohConfigSchema)
# -----------------------------------------------------------------------------
# WebSocket URL of the Zenoh router's remote-api plugin. Required.
# Inside Docker, the entrypoint defaults this to ws://localhost:10000 (the in-container zenohd).
# ZENOH_ROUTER_URL=ws://localhost:10000

# Optional credentials for Zenoh authentication.
# ZENOH_USER=
# ZENOH_PASSWORD=

# Optional prefix prepended to all subscription topics.
# e.g. if prefix is "nato" and subscription topic is "sensors/temp",
# the adapter subscribes to "nato/sensors/temp".
# ZENOH_TOPIC_PREFIX=

# -----------------------------------------------------------------------------
# Docker / Zenoh Bridge (not in config schema; used by entrypoint only)
# -----------------------------------------------------------------------------
# When set, the in-container zenohd runs in peer/bridge mode and connects
# to this external Zenoh router via native Zenoh TCP protocol.
# When unset, zenohd runs as a standalone router.
# Format: tcp/<host>:<port>
ZENOH_EXTERNAL_ROUTER_URL=tcp/host.docker.internal:7447

# -----------------------------------------------------------------------------
# TAK Server Connection (TakConfigSchema)
# -----------------------------------------------------------------------------
# TAK server host and port. Required.
TAK_HOST=tak.example.com
TAK_PORT=8089

# -----------------------------------------------------------------------------
# TAK Heartbeat (TakConfigSchema.heartbeat)
# -----------------------------------------------------------------------------
# Enable periodic heartbeat CoT. Default: false
# TAK_HEARTBEAT_ENABLED=false

# Display callsign for heartbeat and CoT. Default: zeno-adapter
# TAK_HEARTBEAT_CALLSIGN=zeno-adapter

# UID for the callsign heartbeat. Default: zeno-tak-adapter-<uuid>
# TAK_HEARTBEAT_CALLSIGN_UID=zeno-adapter-callsign-uid

# Team/group role and name shown in TAK. Defaults: Team Member, Dark Blue
# TAK_HEARTBEAT_GROUP_ROLE=Team Member
# TAK_HEARTBEAT_GROUP_NAME=Dark Blue

# Heartbeat interval in milliseconds. Default: 10000
# TAK_HEARTBEAT_INTERVAL_MS=10000

# Connection identifier sent to the TAK server. Default: zeno-adapter
TAK_CONNECTION_ID=zeno-adapter

# Reconnect interval in milliseconds after TAK connection drops. Default: 5000
TAK_RECONNECT_INTERVAL=5000

# -----------------------------------------------------------------------------
# TAK TLS (TakConfigSchema.tls)
# -----------------------------------------------------------------------------
# Paths to PEM files or inline PEM content. All optional.
TAK_TLS_CERT=./certs/client.pem
TAK_TLS_KEY=./certs/client-key.pem
TAK_TLS_CA=./certs/ca.pem
TAK_TLS_PASSPHRASE=
# true/false or 1/0. Default: false
TAK_TLS_REJECT_UNAUTHORIZED=false

# -----------------------------------------------------------------------------
# Consumer: Zenoh -> TAK (SubscriptionSchema[])
# -----------------------------------------------------------------------------
# JSON array of subscription objects. Each object:
#   topic     - Zenoh key expression (supports ** wildcards). Required.
#   transform - Transform plugin name. Default: identity
#   overrides - Optional key/value overrides for the transform context
#
# Examples:
#   ZENOH_SUBSCRIPTIONS='[{"topic":"demo/test","transform":"simple-cot"}]'
#   ZENOH_SUBSCRIPTIONS='[{"topic":"sensors/**","transform":"raw-json"},{"topic":"units/position","transform":"simple-cot"}]'
#   ZENOH_SUBSCRIPTIONS='[{"topic":"demo/test","transform":"raw-json","overrides":{"staleMinutes":"5"}}]'
#
ZENOH_SUBSCRIPTIONS='[{"topic":"demo/test","transform":"simple-cot"}]'

# -----------------------------------------------------------------------------
# Producer: TAK -> Zenoh (ProducerConfigSchema)
# -----------------------------------------------------------------------------
# When enabled, CoT events from the TAK server are published as raw CoT XML
# to a single Zenoh topic. Optional; defaults disabled.
PRODUCER_ENABLED=true
PRODUCER_TOPIC=tak/cot

# -----------------------------------------------------------------------------
# Transforms (ConfigSchema.transformsDir)
# -----------------------------------------------------------------------------
# Directory containing custom transform plugins (.ts or .js files).
# Each file should default-export an object implementing TransformPlugin.
# Built-in transforms: identity, raw-json, simple-cot.
TRANSFORMS_DIR=./transforms

# -----------------------------------------------------------------------------
# Logging (ConfigSchema.logLevel)
# -----------------------------------------------------------------------------
# Log level: error, warn, info, debug. Default: info
LOG_LEVEL=info
